Sub UniqueCategories()
    Dim ws As Worksheet
    Dim newWs As Worksheet
    Dim lastRow As Long
    Dim i As Long
    Dim newRow As Long
    Dim uniqueValues As New Collection
    Dim value As Variant
    
    ' Создаем новый лист для сохранения данных
    Set newWs = ThisWorkbook.Sheets.Add(After:=ThisWorkbook.Sheets(ThisWorkbook.Sheets.Count))
    newWs.Name = "Уникальные категории"
    newRow = 1
    
    ' Обрабатываем каждый лист
    For Each ws In ThisWorkbook.Sheets
        ' Проверяем, не является ли текущий лист новым листом для сохранения данных
        If ws.Name <> newWs.Name Then
            lastRow = ws.Cells(ws.Rows.Count, 5).End(xlUp).Row ' Находим последнюю заполненную строку в пятом столбце
            
            ' Проверяем, что в пятом столбце есть хотя бы две ячейки
            If lastRow >= 2 Then
                ' Обрабатываем каждую ячейку в пятом столбце, начиная со второй строки
                For i = 2 To lastRow
                    value = ws.Cells(i, 5).value
                    
                    ' Проверяем, является ли значение уникальным
                    If Not IsInCollection(uniqueValues, value) Then
                        uniqueValues.Add value, CStr(value)
                        newWs.Cells(newRow, 1).value = value
                        newRow = newRow + 1
                    End If
                Next i
            End If
        End If
    Next ws
End Sub

Function IsInCollection(col As Collection, val As Variant) As Boolean
    On Error Resume Next
    col.Item (CStr(val))
    IsInCollection = (Err.Number = 0)
    On Error GoTo 0
End Function
