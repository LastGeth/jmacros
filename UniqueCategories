Sub UniqueCategories()
    Dim ws As Worksheet
    Dim lastRow As Long
    Dim i As Long
    Dim uniqueValues As New Collection
    Dim value As Variant
    Dim uniqueCount As Long
    
    ' Обрабатываем каждый лист
    For Each ws In ThisWorkbook.Sheets
        lastRow = ws.Cells(ws.Rows.Count, 5).End(xlUp).Row ' Находим последнюю заполненную строку в пятом столбце
        
        ' Обрабатываем каждую ячейку в пятом столбце, начиная со второй строки
        For i = 2 To lastRow
            value = ws.Cells(i, 5).value
            
            ' Проверяем, является ли значение уникальным и не пустым
            If Not IsEmpty(value) And Not IsInCollection(uniqueValues, value) Then
                uniqueValues.Add value, CStr(value)
            End If
        Next i
    Next ws
    
    ' Определяем количество уникальных значений
    uniqueCount = uniqueValues.Count
    
    ' Отображаем окно с количеством уникальных значений
    MsgBox "Количество уникальных значений: " & uniqueCount, vbInformation
End Sub

Function IsInCollection(col As Collection, val As Variant) As Boolean
    On Error Resume Next
    col.Item (CStr(val))
    IsInCollection = (Err.Number = 0)
    On Error GoTo 0
End Function
